<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>FCC Random Quotes Challenge</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.min.js'></script>
    <script src='https://unpkg.com/axios/dist/axios.min.js'></script>

    <script src='https://unpkg.com/styled-components/dist/styled-components.min.js'></script>
    <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css'>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div id='mountNode'></div>
<script src='https://unpkg.com/babel-standalone@6/babel.min.js'></script>
<!-- Your custom script here -->
<script type="text/babel">
      const Quote = (props) => {
        return (
                <div style={{margin: '1em'}}>
                    <div style={{display: 'inline-block', marginLeft:10}}>
                        <div style={{fontSize: '1.25em', fontWeight: 'bold'}}>
                          {props.quote}
                        </div>
                        <br></br>
                        <div>Tweet It!....</div>
                    </div>
                </div>
        );
      };

      const QuoteRend = (props) => {
        return (
                <div>
                  {props.quote}
                </div>
        );
      }

      // Quote.rest Attribution
      const Attribution = (props) => {
        return (
                <div style={{display: 'inline-block', marginLeft:10}}>
                    <a href="https://formatics.com" title="Powered by quotes from formatics.com">
                        formatics.com
                    </a>
                </div>
        );
      }
      class Tweet extends React.Component {
        tweetOut = (props) => {
          const {quote} = this.props;
          window.open("https://twitter.com/intent/tweet?text=" + quote);
        }

        render () {
          return (
                  <button onClick={this.tweetOut}>Tweet Quote</button>
          )
        }
      }
      // add button to generate new quote
      class Button extends React.Component {
//   disable cors for this to work. `open -a Google\ Chrome --args --disable-web-security --user-data-dir`
        handleClick = (event) => {
          event.preventDefault();
          // console.log("Event: Handle Click");
          axios.get(`https://api.forismatic.com/api/1.0/?method=getQuote&key=457653&format=json&lang=en`)
            .then(resp => {
              const quote = resp.data.quoteText;
              // this.setState({quote});
              this.props.onClick({quote})
              // console.log({quote});
            });
        };
        render() {
          return (
                  <button onClick={this.handleClick}>Get Quote</button>
          )
        }
      }
      const Root = (props) => {
        const Title = styled.h1`
          font-size: 1.5em;
          text-align: center;
          color: palevioletred;
        `;

        // Create a <Wrapper> react component that renders a <section> with
        // some padding and a papayawhip background
        const Wrapper = styled.section`
          padding: 4em;
          background: papayawhip;
        `;
        return (
                <Wrapper>
                    <Title>Hello World, this is my first styled component!</Title>
                </Wrapper>
        );
      }
      class QuoteApp extends React.Component {
        state = { quote:"Hey There! This is not a Quote but go ahead and click the button to get one!"}
        // this.addNewQuote = this.addNewQuote.bind(this)

        // handler for adding new quote. can call this from button component for it to do what we want.
        addNewQuote = (quoteInfo) => {
          this.setState(quoteInfo);
        }
        render () {
          return (
                  <div className="App">
                      <div className="App-header">
                          <img src="./fcc-logo.svg" className="App-logo" alt="logo" />
                          <h2>The Random Quote Machine</h2>
                      </div>
                      <QuoteRend className="quoteDisplay" quote={this.state.quote}/>
                      <Root />

                      <Button className="btn-primary" onClick={this.addNewQuote}/>
                      <Tweet quote={this.state.quote}/>
                      <Attribution />
                  </div>
          )
        }
      }
      ReactDOM.render(<QuoteApp />, mountNode);
    </script>

</body>
</html>